<% layout('../_common/layouts/general') %>


<style type="text/css">
	
</style>

<div id="mainCtrl" class="px-0 pt-2">
	<form></form>
</div>
<script type="text/javascript">

	function sayfaBul(){
		document.title=hashObj.title + ' - GanyGO'
		$('#pageTitle').html(`<i class="${hashObj.icon}"></i> ${hashObj.breadCrumbsHtml}`)
		var sayfa=getPropertyByKeyPath(global.pages,hashObj.pathKey)
		if(!sayfa)
			return null
		var resp
		switch(hashObj.func){
			case 'edit':
			resp=sayfa.edit || sayfa.form
			break
			case 'view':
			resp=sayfa.view || sayfa.edit || sayfa.form || null
			break
			case 'print':
			resp=sayfa.print || sayfa.edit || sayfa.form || null
			break
			case 'addnew':
			resp=sayfa.addnew || sayfa.form || null
			break

			case '':
			case 'index':
			resp= sayfa.index || null
			break
			default:
			resp=sayfa[hashObj.func] || null
			break
		}
		return resp
	}
	
	function sayfayiAcalim(callback){
		if((((hashObj || {}).query || {}).mid || '')!=''){
			$(`#leftMenu a`).removeClass('active')
			$(`#leftMenu #menu${hashObj.query.mid.replaceAll('.','-')}`).addClass('active')
		}
		toggleMenu()
		var sayfa=sayfaBul()
		if(sayfa){
		
			generatePage('#mainCtrl form',sayfa,callback)
		
		}else{
			$('#mainCtrl form').html('sayfa bulunamadi')
			callback()
		}
	}
	

	if(window.location.hash==''){
		window.location.hash='/dashboard/main'
		
	}

	let bNoAction=false

	$(document).ready(()=>{
		anotherViewStyle('mainCtrl')
		sayfayiAcalim()
		window.onhashchange=()=>{
			if(bNoAction)
				return
			bNoAction=true
			hashObj=getHashObject()
			anotherViewStyle('mainCtrl')

			$('#mainCtrl form').html('loading...')
			sayfayiAcalim(()=>{
				bNoAction=false
			})
		}
	})


	function toggleMenu(status){
		if(status=='show'){
			$('#layoutSidenav_nav').toggle(0)
		}else if(window.innerWidth<1000){
			$('#layoutSidenav_nav').hide()
			
		}
	}
</script>
